@page "/settings"
@using Microsoft.AspNetCore.Authorization
@attribute [Authorize(Roles = "Administrator,Admin")]
@inject NavigationManager Navigation

<PageTitle>Platform Settings - Fab O.S</PageTitle>

<div class="settings-header mb-4">
    <h1>Platform Settings</h1>
    <p class="lead text-muted">Manage platform-wide settings and configuration</p>
</div>

<div class="row">
    <!-- OPERATIONAL SETTINGS COLUMN -->
    <div class="col-lg-6">
        <h3 class="section-title mb-3">
            <i class="fas fa-cogs"></i> Operational Settings
        </h3>
        
        <!-- Production & Resources Section -->
        <div class="card mb-4">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0"><i class="fas fa-industry"></i> Production & Resources</h5>
            </div>
            <div class="card-body">
                <p>Configure production resources and workflows</p>
                <div class="list-group">
                    <a href="/settings/business-configuration/work-centers" class="list-group-item list-group-item-action">
                        <i class="fas fa-industry me-2"></i>
                        <strong>Work Centers</strong>
                        <small class="d-block text-muted">Manage production work centers</small>
                    </a>
                    <a href="/settings/business-configuration/machine-centers" class="list-group-item list-group-item-action">
                        <i class="fas fa-cogs me-2"></i>
                        <strong>Machine Centers</strong>
                        <small class="d-block text-muted">Configure machines and equipment</small>
                    </a>
                    <a href="/settings/business-configuration/routing-templates" class="list-group-item list-group-item-action">
                        <i class="fas fa-project-diagram me-2"></i>
                        <strong>Routing Templates</strong>
                        <small class="d-block text-muted">Production routing and operation sequences</small>
                    </a>
                </div>
            </div>
        </div>

        <!-- Material & Efficiency Section -->
        <div class="card mb-4">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0"><i class="fas fa-cubes"></i> Material & Efficiency</h5>
            </div>
            <div class="card-body">
                <p>Material types and efficiency configurations</p>
                <div class="list-group">
                    <a href="/admin/material-settings" class="list-group-item list-group-item-action">
                        <i class="fas fa-boxes me-2"></i>
                        <strong>Material Settings</strong>
                        <small class="d-block text-muted">Material types and patterns</small>
                    </a>
                    <a href="/admin/efficiency-rates" class="list-group-item list-group-item-action">
                        <i class="fas fa-percentage me-2"></i>
                        <strong>Efficiency Rates</strong>
                        <small class="d-block text-muted">Efficiency presets and rates</small>
                    </a>
                    <a href="/admin/connection-types" class="list-group-item list-group-item-action">
                        <i class="fas fa-link me-2"></i>
                        <strong>Connection Types</strong>
                        <small class="d-block text-muted">Welding connection types</small>
                    </a>
                </div>
            </div>
        </div>

        <!-- Display & Preferences Section -->
        <div class="card mb-4">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0"><i class="fas fa-desktop"></i> Display & Preferences</h5>
            </div>
            <div class="card-body">
                <p>User interface and personal preferences</p>
                <div class="list-group">
                    <a href="/settings/display-settings" class="list-group-item list-group-item-action">
                        <i class="fas fa-palette me-2"></i>
                        <strong>Display Settings</strong>
                        <small class="d-block text-muted">UI preferences and themes</small>
                    </a>
                    <a href="/settings/user-preferences" class="list-group-item list-group-item-action">
                        <i class="fas fa-user-cog me-2"></i>
                        <strong>User Preferences</strong>
                        <small class="d-block text-muted">Personal settings and defaults</small>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- GENERAL BUSINESS SETTINGS COLUMN -->
    <div class="col-lg-6">
        <h3 class="section-title mb-3">
            <i class="fas fa-briefcase"></i> General Business Settings
        </h3>
        
        <!-- User Management Section -->
        <div class="card mb-4">
            <div class="card-header bg-secondary text-white">
                <h5 class="mb-0"><i class="fas fa-users"></i> User Management</h5>
            </div>
            <div class="card-body">
                <p>Manage platform users and access</p>
                <div class="list-group">
                    <a href="/admin/users" class="list-group-item list-group-item-action">
                        <i class="fas fa-users-cog me-2"></i>
                        <strong>User Management</strong>
                        <small class="d-block text-muted">Create, edit, and manage users</small>
                    </a>
                    <a href="/admin/invites" class="list-group-item list-group-item-action">
                        <i class="fas fa-envelope-open-text me-2"></i>
                        <strong>User Invitations</strong>
                        <small class="d-block text-muted">Send invitations to new users</small>
                    </a>
                </div>
            </div>
        </div>

        <!-- System Configuration Section -->
        <div class="card mb-4">
            <div class="card-header bg-purple text-white">
                <h5 class="mb-0"><i class="fas fa-sliders-h"></i> System Configuration</h5>
            </div>
            <div class="card-body">
                <p>Configure system-wide settings</p>
                <div class="list-group">
                    <a href="/settings/number-series" class="list-group-item list-group-item-action">
                        <i class="fas fa-hashtag me-2"></i>
                        <strong>Number Series</strong>
                        <small class="d-block text-muted">Configure auto-numbering for all entities</small>
                    </a>
                    <a href="/admin/settings" class="list-group-item list-group-item-action">
                        <i class="fas fa-cog me-2"></i>
                        <strong>General Settings</strong>
                        <small class="d-block text-muted">GitHub integration and system configuration</small>
                    </a>
                    <a href="/admin/environment-status" class="list-group-item list-group-item-action">
                        <i class="fas fa-server me-2"></i>
                        <strong>Environment Status</strong>
                        <small class="d-block text-muted">View deployment status and health</small>
                    </a>
                </div>
            </div>
        </div>

        <!-- Module Management Section -->
        <div class="card mb-4">
            <div class="card-header bg-orange text-white">
                <h5 class="mb-0"><i class="fas fa-th"></i> Module Management</h5>
            </div>
            <div class="card-body">
                <p>Configure module access and licensing</p>
                <div class="list-group">
                    <a href="/settings/modules" class="list-group-item list-group-item-action">
                        <i class="fas fa-puzzle-piece me-2"></i>
                        <strong>Module Access</strong>
                        <small class="d-block text-muted">Configure module access per company</small>
                    </a>
                    <a href="/settings/product-roles" class="list-group-item list-group-item-action">
                        <i class="fas fa-user-tag me-2"></i>
                        <strong>Module Roles</strong>
                        <small class="d-block text-muted">Manage roles within each module</small>
                    </a>
                </div>
            </div>
        </div>

        <!-- System Tools Section -->
        <div class="card mb-4">
            <div class="card-header bg-warning">
                <h5 class="mb-0"><i class="fas fa-tools"></i> System Tools</h5>
            </div>
            <div class="card-body">
                <p>System health and maintenance tools</p>
                <div class="list-group">
                    <a href="/health" class="list-group-item list-group-item-action" target="_blank">
                        <i class="fas fa-heartbeat me-2"></i>
                        <strong>Health Check</strong>
                        <small class="d-block text-muted">System health diagnostics</small>
                    </a>
                    <a href="/settings/logs" class="list-group-item list-group-item-action">
                        <i class="fas fa-file-alt me-2"></i>
                        <strong>System Logs</strong>
                        <small class="d-block text-muted">View application logs and errors</small>
                    </a>
                    <a href="/admin/run-migration" class="list-group-item list-group-item-action">
                        <i class="fas fa-database me-2"></i>
                        <strong>Run Migrations</strong>
                        <small class="d-block text-muted">Execute database migrations</small>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Quick Stats -->
<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-chart-line"></i> Platform Statistics</h5>
            </div>
            <div class="card-body">
                <div class="row text-center">
                    <div class="col-md-3">
                        <div class="stat-item">
                            <i class="fas fa-users fa-2x text-primary mb-2"></i>
                            <h3>@totalUsers</h3>
                            <p class="text-muted">Total Users</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-item">
                            <i class="fas fa-building fa-2x text-success mb-2"></i>
                            <h3>@totalCompanies</h3>
                            <p class="text-muted">Companies</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-item">
                            <i class="fas fa-cubes fa-2x text-info mb-2"></i>
                            <h3>@activeModules</h3>
                            <p class="text-muted">Active Modules</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="stat-item">
                            <i class="fas fa-server fa-2x text-warning mb-2"></i>
                            <h3>@currentEnvironment</h3>
                            <p class="text-muted">Environment</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@code {
    private int totalUsers = 0;
    private int totalCompanies = 0;
    private int activeModules = 4;
    private string currentEnvironment = "Development";

    protected override async Task OnInitializedAsync()
    {
        // TODO: Load actual statistics from services
        // For now, using placeholder values
        totalUsers = 15;
        totalCompanies = 3;
        
        // Get current environment
        var env = Environment.GetEnvironmentVariable("ASPNETCORE_ENVIRONMENT");
        currentEnvironment = env ?? "Development";
    }
}

<style>
    .settings-header {
        border-bottom: 2px solid #e9ecef;
        padding-bottom: 1rem;
    }

    .section-title {
        color: #495057;
        font-weight: 600;
        border-bottom: 2px solid #dee2e6;
        padding-bottom: 0.5rem;
    }

    .stat-item {
        padding: 1.5rem;
    }

    .stat-item h3 {
        margin: 0.5rem 0;
        font-weight: 600;
    }

    .list-group-item {
        border-left: 3px solid transparent;
        transition: all 0.2s ease;
    }

    .list-group-item:hover {
        border-left-color: var(--bs-primary);
        background-color: #f8f9fa;
    }

    .card {
        box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
        transition: transform 0.2s ease;
    }

    .card:hover {
        transform: translateY(-2px);
        box-shadow: 0 0.25rem 0.5rem rgba(0, 0, 0, 0.1);
    }

    .bg-purple {
        background-color: #6f42c1 !important;
    }

    .bg-orange {
        background-color: #fd7e14 !important;
    }

    @@media (max-width: 991px) {
        .section-title {
            margin-top: 2rem;
        }
        
        .section-title:first-child {
            margin-top: 0;
        }
    }
</style>